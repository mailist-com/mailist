<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.20.xsd">

    <!-- Master Changelog for Mailist Application -->
    <!-- All migrations are executed in order -->

    <!-- 001: Create base tables for multi-tenancy -->
    <include file="db/changelog/001-create-organizations.xml"/>

    <!-- 002: Create users and authentication tables -->
    <include file="db/changelog/002-create-users.xml"/>
    <include file="db/changelog/003-create-user-preferences.xml"/>
    <include file="db/changelog/004-create-refresh-tokens.xml"/>

    <!-- 003: Create marketing automation tables -->
    <include file="db/changelog/005-create-contacts.xml"/>
    <include file="db/changelog/006-create-contact-lists.xml"/>
    <include file="db/changelog/007-create-campaigns.xml"/>
    <include file="db/changelog/008-create-automation-rules.xml"/>
    <include file="db/changelog/009-create-reports.xml"/>

    <!-- 004: Create indexes for performance -->
    <include file="db/changelog/010-create-indexes.xml"/>

    <!-- 005: Fix missing columns in automation tables -->
    <include file="db/changelog/011-fix-automation-actions-columns.xml"/>

    <!-- 006: Fix column names to match JPA entities -->
    <include file="db/changelog/012-fix-automation-columns.xml"/>

    <!-- 007: Fix contacts and contact_lists tables -->
    <include file="db/changelog/013-fix-contacts-and-lists.xml"/>

    <!-- 008: Remove organization references, use only tenant_id -->
    <include file="db/changelog/014-remove-organization-references.xml"/>

    <!-- 009: Fix organization plan enum values -->
    <include file="db/changelog/015-fix-organization-plan-values.xml"/>

    <!-- 010: Remove subdomain from organizations - not needed for internal multi-tenancy -->
    <include file="db/changelog/016-remove-organization-subdomain.xml"/>

    <!-- 011: Fix sequence values after manual inserts to prevent duplicate key errors -->
    <include file="db/changelog/017-fix-sequence-after-inserts.xml"/>

    <!-- 012: Create API keys tables for external integrations -->
    <include file="db/changelog/018-create-api-keys.xml"/>

    <!-- 012: Add contact_list_tags table for storing tags associated with contact lists -->
    <include file="db/changelog/018-add-contact-list-tags-table.xml"/>

    <!-- 013: Fix automation condition type enum values to match Java enum (uppercase) -->
    <include file="db/changelog/019-fix-automation-condition-type-enum.xml"/>

    <!-- 014: Add flow_json column to automation_rules for storing complete flow definition -->
    <include file="db/changelog/020-add-flow-json-to-automation-rules.xml"/>

    <!-- 015: Create email_events table for dashboard analytics and email tracking -->
    <include file="db/changelog/021-create-email-events.xml"/>

    <!-- 016: Add new columns to campaigns table for enhanced campaign management -->
    <include file="db/changelog/022-add-campaign-columns.xml"/>

    <!-- 017: Create automation_steps table for storing parsed automation flow steps -->
    <include file="db/changelog/023-create-automation-steps.xml"/>

    <!-- 018: Cleanup old automation columns - data now in automation_steps -->
    <include file="db/changelog/024-cleanup-old-automation-columns.xml"/>

    <!-- 019: Add new user preference fields for enhanced profile settings -->
    <include file="db/changelog/025-add-user-preferences-fields.xml"/>

    <!-- 020: Create notifications table for user notifications system -->
    <include file="db/changelog/026-create-notifications.xml"/>

    <!-- 021: Create automation_executions and automation_step_executions tables for tracking automation flow -->
    <include file="db/changelog/027-create-automation-executions.xml"/>

    <!-- 022: Create templates table for email templates management -->
    <include file="db/changelog/028-create-templates.xml"/>

    <!-- 023: Refactor templates - remove design settings, add custom fields -->
    <include file="db/changelog/029-refactor-templates-custom-fields.xml"/>

    <!-- 024: Create subscription system with payment providers and invoicing -->
    <include file="db/changelog/030-create-subscription-system.xml"/>

</databaseChangeLog>
